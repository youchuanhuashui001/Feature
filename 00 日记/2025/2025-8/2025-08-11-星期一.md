


# 今日工作安排
- Sagitta IR BBT 测试程序，已完成
- 支持 DM SPINor、SPINand flash

待尝试：将发送引脚映射到P20，使用逻辑分析仪抓取发送波形，手动解析数据。
Apus：芯片的红外管脚为专用管脚，不需要配置管脚复用。

调试红外接收：

- 接收时配置0x3c寄存器为0x180，发送时配置为0x280，使能模拟接收连接到test引脚。
- 接收时可通过test引脚（J31）测量模拟电路的波形。
- 配置0x10寄存器的inv_en，为0，取消反相。取消后，接收FIFO不再出现未发送数据时满的情况。

使用逻辑分析仪抓取test上的模拟电路波形，发现波形不带载波，调整遥控器距离红外头的位置，更远一些，接收到的波形部分带载波，部分不带。
应该是模拟电路的参数配置不合适，广州同事继续调试模拟参数，模拟输出波形稳定后再进行测试。

接外部模拟电路，芯片仅使用数字部分进行测试，P3_7->IR_EMIT P1_2->IR_REC1 P1_7->IR_REC2

配置管脚复用P3_7->IR_EMIT P1_2->IR_REC1 P1_7->IR_REC2，采用和之前测fpga一样的配置，0x40寄存器配置为0x2，0x3c寄存器的tx en为0，发送nec协议数据，使用逻辑分析仪测量P3_7引脚，可测量到正常的波形。


测量通过芯片内部模拟电路发出来的波形，通红外头引脚测量，有波形输出但质量不好：

调节红外电路上的可调电阻，默认11.2欧，调至2欧，测试结果与之前一致，无法接收，信号波形跟之前差不多。调至最小的0.6v，测试结果一致。需要更换二极管后再试试。





- Apus Flash Socket 板测试
	- 连接 P3_4 和 IR，使用标准协议发送和标准协议接收，逻辑分析仪都抓不到数据
# Apus_NRE 板子测试
- 接收：逻辑分析仪量R14引脚，能够量到波形，这里是过了发射管，所以有钳位，量到的电压就是高电平和低电平的差值是0.7v
![[eaa101ac80e6a6de6612d36ba47d274f.jpg]]
- 发射：逻辑分析仪量R14引脚，能够量到波形，高电平和低电平的差值依然是0.7v，但是过冲的位置看下来有 1.8v
![[92effaf79a005c536736ca67ef090abc.jpg]]


# 工作进展




