---
tags:
  - Virgo_MPW模块验证
---
# 验证进度：
- 总验证点:: 3
- 已完成:: 3
- 备注:: 无


# 修改点
- 时钟：148.5MHz，分频至 32K
- 引脚：不需要


# 验证项

## 产生 1Hz 计数
- 148.5MHz 预分频不了这么多，所以不能产生 1Hz 计数
- 148.5MHz 单个 tick 时间是 6.734ns
- 在 **148.5 MHz** 时钟频率下，计数 **148,500,000 次** 才可达到 1 秒。而预分频最大只能到 65535，所以这里分不到 1Hz。


- 将时钟分频到 32k.00006，测试是 1Hz 计数，基本感受不到有不准的情况



## 分频配置
- 可以正常分频
- 分频 14850 到 100us 一个tick
```
[2025-07-04 20:57:50] boot> rtc read
[2025-07-04 20:57:51] rtc time is 163814
[2025-07-04 20:57:51] boot> rtc read
[2025-07-04 20:57:51] rtc time is 167124
[2025-07-04 20:57:51] boot> rtc read
[2025-07-04 20:57:51] rtc time is 170553
[2025-07-04 20:57:51] boot> rtc read
[2025-07-04 20:57:52] rtc time is 174032
[2025-07-04 20:57:52] boot> rtc read
[2025-07-04 20:57:52] rtc time is 177204
[2025-07-04 20:57:52] boot> rtc read
[2025-07-04 20:57:52] rtc time is 180223
```
- 10000 个 tick，则是  1s，测试正常


## 开启闹钟功能
- 设定 3s，也就是 30000 个 tick，能够触发irq
```
[2025-07-04 21:00:53] boot> rtc set_alarm 30000
[2025-07-04 21:00:54] boot> <INTERRUPT>
[2025-07-04 21:00:54] boot> <INTERRUPT>
[2025-07-04 21:00:54] boot> <INTERRUPT>
[2025-07-04 21:00:55] boot> <INTERRUPT>
[2025-07-04 21:00:55] boot> <INTERRUPT>
[2025-07-04 21:00:55] boot> <INTERRUPT>
[2025-07-04 21:00:55] boot> <INTERRUPT>
[2025-07-04 21:00:55] boot> <INTERRUPT>
[2025-07-04 21:00:55] boot> <INTERRUPT>
[2025-07-04 21:00:55] boot> <INTERRUPT>
[2025-07-04 21:00:56] boot> <INTERRUPT>
[2025-07-04 21:00:56] boot> <INTERRUPT>
[2025-07-04 21:00:56] boot> <INTERRUPT>
[2025-07-04 21:00:56] boot> <INTERRUPT>
[2025-07-04 21:00:57] boot> <INTERRUPT>
[2025-07-04 21:00:57] boot> <INTERRUPT>
[2025-07-04 21:00:57] boot> <INTERRUPT>
[2025-07-04 21:00:57] boot> RTC interrupt triggered!
[2025-07-04 21:00:57] tick1: 1997545, tick2: 2027545, Difference: 30000
```



# 问题

## 【已完成】RTC 无法分到 1HZ
- rtc 预分频寄存器最大可配 0xffff，也就是 65535，那么模块频率只能是 32K或者64K
- 分频到 32.000xKHz，可以实现 1Hz