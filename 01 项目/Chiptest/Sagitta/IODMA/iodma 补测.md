
# 增加单线模式，回归验证
- ok





# 灯效

https://github.com/kitesurfer1404/WS2812FX

## 如何表示 bit1、bit0
- 现表示的方式：
	- 2byte 表示一个 ws2812 的 bit，2byte 为另一个输出脚，不输出；时钟频率是 32MHz，一个周期是 31.25ns；配置的延时是 2，那么实际的周期数就是 `31.25*3 = 93.75ns`
	- bit1：`0x00005555` 就是 8 个 1，8 个 0，高电平时长为 `93.75*8 = 750ns`，低电平 `750ns`
	- bit0：`0x00000555` 就是 6 个 1，10 个 0，高电平时长为 `93.75*6 = 562.5ns`，低电平 `937.5ns`
- 换成用 6bit 表示：
- 换成用 4bit 表示：

8MHZ：一个周期是 125ns
- 4bit 表示：
	- bit1：`0011`：


- 原本的波形：
	- bit0：
		- 高电平时长：360ns
		- 低电平时长：620ns
	- bit1：
		- 高电平时长：500ns
		- 低电平时长：500ns


- 用 4bit 表示的时候，好像没有到 5v 电压，一直在 3.3v
- 换成使用 16MHz，


## 【已解决】Q1：tx_delay 配到很大的时候电压会往下掉
- tx_delay 配成 2/3
![[aa809ea92b027e33db97c0fd05e5a80a.jpg]]
- tx_delay 配成 15000
![[740426926a050163030b19909d7d11ca.jpg]]
- tx_delay 配成 1000
![[36aa0f9079934b76b2c5efedf4dceb10.jpg]]
- tx_delay 配成 5000
![[5a934ae853dc8751e3f4884fb43d72f7.jpg]]
- tx_delay 配成 3000
![[ff5f2cc633a7849a0c5b043e971c138f.jpg]]

- tx_delay 配成 2000
![[8905802beedefecbae40570a0a4fe386.jpg]]


- **A：gen_spi 分配比配的很大的时候也是一样的**


## QMK 如何表示各种不同的灯效
- 网站： https://wokwi.com/projects/404843885655728129
	- 在线模拟 esp32 和 ws2812 
- hsv：
	- h：Hue 色相
		- 色相通过一个角度值来表示，范围 `0~360°`
		- 0 表示红色、120 表示绿色、240 表示蓝色
		- 通过调整色相，可以改变颜色的类别。
		- 例如：从 0~120，颜色从红色逐渐过渡到绿色
	- s：Saturation 饱和度
		- 饱和度表示颜色的纯度或强度。饱和度越高，颜色越鲜艳；饱和度越低，颜色越接近灰色；范围 `0~100%`
		- `0%` 表示灰色 (无色彩)
		- `100%` 表示最纯净、最鲜艳的颜色。
		- 例如：一个高饱和度的红色会非常鲜艳，而低饱和度的红色则偏向灰红色。
	- v：Value 明度
		- 明度表示颜色的亮度。亮度越高，颜色越亮；亮度越低，颜色越暗；范围 `0~100%`
		- `0%` 表示完全黑色
		- `100%` 表示最亮的颜色
		- 例如：一个高明度的黄色会显得明亮耀眼，而低明度的黄色则显得暗淡。
- 不同的灯效做成回调，定时器中根据当前的模式跳到对应的回调中处理灯光效果
- rainbow：
	- 有一个定时器，定时器会定时更新灯光数据
	- 更新灯光数据，则根据参数来修改 `hsv.h` 也就是色相值即可完成 rainbow
- breath：
	- 有一个定时器，定时器会定时更新灯光数据
	- 根据配置的参数，计算得到新的 `hsv.v` 也就是明亮度，即可完成 breath





# 带死区 pwm
