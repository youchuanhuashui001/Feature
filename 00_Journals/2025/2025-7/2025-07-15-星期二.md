


# **ğŸ”§ ä»Šæ—¥å·¥ä½œå®‰æ’**
- Virgo_MPW 4.19 pwm-regulatorï¼Œå…ˆæ”¯æŒ gpioï¼Œå†æ”¯æŒ pwmï¼Œæœ€åæ”¯æŒ pwm-regulator
	- gpio å·²è°ƒé€š
- Virgo_MPW GPIO åŠŸè€—æµ‹è¯•ï¼Œé…ç½®å»æ‰å†…éƒ¨ä¸Šæ‹‰ï¼Œæ— è®ºæ˜¯å¦æ˜¯ gpio åŠŸèƒ½ï¼Œéƒ½å»æ‰å†…éƒ¨ä¸Šæ‹‰ã€‚
	- å¦‚æœå¤ç”¨æˆå…¶å®ƒçš„åŠŸèƒ½ï¼Œç¡¬ä»¶ä¸Šéƒ½ä¼šåŠ ä¸Šæ‹‰ã€‚
	- é©±åŠ¨å¼ºåº¦é»˜è®¤æ˜¯æœ€ä½ï¼Œä¸éœ€è¦ä¿®æ”¹
```diff
--- a/drivers/padmux/virgo_padmux.c
+++ b/drivers/padmux/virgo_padmux.c
@@ -14,6 +14,7 @@
 #define CHIP_PIN_PER_REG   1   // æ¯ä¸ªå¯„å­˜å™¨æœ‰å¤šå°‘ä¸ªç®¡è„šå¤ç”¨é…ç½®
 #define CHIP_PIN_BITS      16   // æ¯ä¸ªç®¡è„šå¤ç”¨å ç”¨å¯„å­˜å™¨bitæ•°
 #define CHIP_PIN_MASK      0xF // ç®¡è„šå¤ç”¨é…ç½®æ©ç (æ¯4ä¸ªbitä½é…ç½®ä¸€ä¸ªç®¡è„šå¤ç”¨)
+#define CHIP_PIN_MASK_NOPU 0x3F // ç®¡è„šå¤ç”¨é…ç½®æ©ç (æ¯4ä¸ªbitä½é…ç½®ä¸€ä¸ªç®¡è„šå¤ç”¨)
 #define CHIP_PIN_SEL_BASE  (REG_BASE_PIN_CONFIG) // ç®¡è„šå¤ç”¨é…ç½®åŸºåœ°å€
 
 int padmux_get(int pad_id)
@@ -105,7 +106,10 @@ int padmux_set(int pad_id, int function)
        id = pad_id / CHIP_PIN_PER_REG;
 
        pinconfig = __raw_readl(CHIP_PIN_SEL_BASE + base + id*4);
-       pinconfig &= ~(CHIP_PIN_MASK);
+       if ((base == 0) || (base == 0x100) || (base == 0x300) || (base == 0x400) || (base == 0x500))
+               pinconfig &= ~(CHIP_PIN_MASK_NOPU);
+       else
+               pinconfig &= ~(CHIP_PIN_MASK);
        func = (function & CHIP_PIN_MASK);
        pinconfig |= func;
        __raw_writel(pinconfig, CHIP_PIN_SEL_BASE + base + id*4);
```



# **ğŸ“Œ å·¥ä½œè¿›å±•**



---

# **âš ï¸ é—®é¢˜ä¸è§£å†³**


---

# **ğŸ’¡ æŠ€æœ¯æ€»ç»“**


---

# **ğŸ“š çŸ¥è¯†å…³è”**


---
# **ğŸ“Œ æ˜æ—¥è®¡åˆ’**


---

# **ğŸ’¬ æ‰©å±•è®°å½•**



